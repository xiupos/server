{
  email {env.MAIL}
}

(cloudflare) {
  tls {
    dns cloudflare {env.CF_API_TOKEN}
    resolvers 1.1.1.1
  }
}

(default) {
  header_up Host {host}
  transport http {
    versions 1.1
  }

  header_up X-Real-IP {remote_addr}
  header_up X-Forwarded-For {proxy_add_x_forwarded_for}
  header_up X-Forwarded-Proto https
}

mk.xiupos.net {
  import cloudflare
  reverse_proxy sapporo:3000 {
    import default
  }
}

mk-dev.xiupos.net {
  import cloudflare
  reverse_proxy sapporo:3001 {
    import default
  }
}

m.huling.org {
  import cloudflare
  reverse_proxy sapporo:3002 {
    import default
  }
}

phys.xiupos.net {
  import cloudflare
  reverse_proxy sapporo:3003 {
    import default
  }
}

workflow.xiupos.net {
  import cloudflare
  reverse_proxy sapporo:3004 {
    import default
  }
}

tokyo.xiupos.net {
  import cloudflare
  reverse_proxy netdata:19999 {
    import default
  }
}

sapporo.xiupos.net {
  import cloudflare
  reverse_proxy sapporo:19999 {
    import default
  }
}
